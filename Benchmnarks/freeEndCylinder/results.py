import numpy as np

# 0-90-0 results 
defA_090=[0.  , 0.05       , 0.1        , 0.15       , 0.2        , 0.25       , 0.3        , 0.35       , 0.4       , 0.45       , 0.5        , 0.55       , 0.6        , 0.65       , 0.7       , 0.75       , 0.8        , 0.85       , 0.9        , 0.95       , 1.         , 1.05       , 1.1        , 1.15       , 1.2        , 1.25       , 1.3        , 1.35       , 1.4        , 1.45       , 1.5        , 1.55       , 1.6        , 1.65       , 1.7        , 1.75       , 1.8        , 1.85       , 1.9       , 1.95       , 2.  ]
loadA_090=[0. , 0.05156268 , 0.07967902 , 0.10071461 , 0.12192412 , 0.14535822 , 0.17022133 , 0.19368672 , 0.2131676 , 0.22772292 , 0.24279351 , 0.25768888 , 0.26644045 , 0.27620116 , 0.2888236 , 0.29681614 , 0.29495491 , 0.30156132 , 0.30984749 , 0.31393746 , 0.31916425 , 0.32850108 , 0.33986193 , 0.33230384 , 0.33255031 , 0.34322475 , 0.35905317 , 0.37957796 , 0.40533842 , 0.43766197 , 0.47840858 , 0.52995653 , 0.59547794 , 0.67930691 , 0.78724117 , 0.92651598 , 1.10513164 , 1.33024902 , 1.6049323 , 1.92959085 , 2.31693886]
loadA_090=[0.,         0.05014857, 0.07811182, 0.09954719, 0.12116963, 0.1441827,0.16758146, 0.18935421, 0.20816613, 0.22428666, 0.23841486, 0.25033372,0.26080369, 0.26928721, 0.27680554, 0.28293635, 0.28848495, 0.29288266,0.29785823, 0.30134034, 0.30706414, 0.3090894,  0.31641616, 0.3201565,0.33007803, 0.33624559, 0.34963024, 0.36862192, 0.38988249, 0.41906247,0.45706302, 0.50309753, 0.55662434, 0.62757285, 0.71887902, 0.8347014,0.98062776, 1.16299126, 1.38784775, 1.65877762, 1.97246269]


wA_090=[0.  , 0.1534 , 0.3792 , 0.55145 , 0.93433 , 1.29575 , 1.41562 , 1.49034 , 1.54634 , 1.59141 , 1.62896 , 1.66099 , 1.68884 , 1.7356 , 1.77404 , 1.8068 , 1.83544 , 1.86099 , 1.88415 , 1.90543 , 1.9252 , 1.94376 , 1.96132 , 1.97808 , 1.9942 , 2.00983]
P_090=  [0. , 0.1    , 0.2    , 0.25    , 0.3     , 0.35    , 0.4     , 0.45    , 0.5     , 0.55    , 0.6     , 0.65    , 0.7     , 0.8    , 0.9     , 1.     , 1.1     , 1.2     , 1.3     , 1.4     , 1.5    , 1.6     , 1.7     , 1.8     , 1.9    , 2.  ]

# 90-0-90 results 
loadA_909=[0.,         0.07413403, 0.12256855, 0.15675294, 0.18674426, 0.21737821,0.24998,    0.2836552,  0.31704443, 0.35058997, 0.37940368, 0.40414852,0.43304356, 0.4455034,  0.46854243, 0.49606892, 0.49790966, 0.52546476,0.55741518, 0.55609553, 0.59571211, 0.64334378, 0.64709213, 0.710608,0.72606412, 0.8029022,  0.90611911, 0.93061306, 1.05905218, 1.10096385,1.25790265, 1.31396773, 1.50059498, 1.58258536, 1.80350194, 1.901906  ]

defA_909=[0.,   0.05, 0.1,  0.15, 0.2,  0.25, 0.3,  0.35, 0.4,  0.45, 0.5,  0.55, 0.6,  0.65,0.7,  0.75, 0.8,  0.85, 0.9,  0.95, 1.,   1.05, 1.1,  1.15, 1.2,  1.25, 1.3,  1.35,1.4,  1.45, 1.5,  1.55, 1.6,  1.65, 1.7,  1.75]

wA_909 = 1.0/100*np.array([ 0,7.558,22.722,30.594,37.897,45.427,54.455,65.814,79.512,92.524,102.357,109.793,115.746,125.094,132.488,138.74,144.238,149.191,153.728,157.93,161.854,165.54,169.017,172.308,175.43,178.386])
P_909=2*np.array([0,0.05,0.1,0.125,0.15,0.175,0.20,0.225,0.25,0.275,0.3,0.325,0.35,0.40,0.45,0.5,0.55, 0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95,1])


# Isotropic results
defA_iso=[0.,   0.05, 0.1,  0.15, 0.2,  0.25, 0.3,  0.35, 0.4,  0.45, 0.5,  0.55, 0.6,  0.65,0.7,  0.75, 0.8,  0.85, 0.9,  0.95, 1.,   1.05, 1.1,  1.15, 1.2,  1.25, 1.3,  1.35,1.4,  1.45, 1.5,  1.55, 1.6,  1.65, 1.7, ]
loadA_iso=[0.,         0.09891095, 0.15616233, 0.19775986, 0.23876871, 0.28266209,0.3310772,  0.3857092,  0.4444031,  0.49582677, 0.52859345, 0.56702685,0.60880317, 0.61640872, 0.62762825, 0.65366841, 0.68777208, 0.71727038,0.69522846, 0.7145951,  0.7504739,  0.79979837, 0.86224607, 0.82690568,0.86763324, 0.93599015, 1.02858386, 1.13916713, 1.14662105, 1.26573354,1.42434978, 1.61636361, 1.57085568, 1.76224383, 1.99248574]
loadA_iso=[0.,         0.09576703, 0.1525019,  0.19434291, 0.23533482, 0.27978465,0.32781075, 0.37803567, 0.42805735, 0.47317266, 0.51225886, 0.54362742,0.57042635, 0.59741979, 0.6133441,  0.63739274, 0.64927396, 0.66516512,0.69047337, 0.69461489, 0.72293375, 0.75539615, 0.76666408, 0.81659542,0.84362764, 0.8972064,  0.98238088, 1.0198311,  1.13202294, 1.19282043,1.33537909, 1.43211031, 1.61449981, 1.73478788, 1.96706282]

wa_iso=[0.,      0.05421, 0.161,   0.22195, 0.27657, 0.327,   0.37582, 0.42633, 0.48537,0.56355, 0.6641,  0.7981,  0.94669, 1.13704, 1.24751, 1.32653, 1.3892,  1.44185,1.4877,  1.52863, 1.56584, 1.60015, 1.63211, 1.662,   1.68973, 1.71505]

P_iso =  [0.,   0.1,  0.2,  0.25, 0.3,  0.35, 0.4,  0.45, 0.5,  0.55, 0.6,  0.65, 0.7, 0.8,0.9,  1.,   1.1,  1.2,  1.3,  1.4,  1.5,  1.6,  1.7,  1.8,  1.9,  2.  ]


import matplotlib.pyplot as plt
# isotropic
plt.plot(defA_iso, loadA_iso, 'or', mfc='none',label="Isotropic")
plt.plot(wa_iso, P_iso, '-r')

# 0-90-0
plt.plot(defA_090, loadA_090, 'ob', mfc='none',label="0-90-0")
plt.plot(wA_090, P_090, '-b')

# 90-0-90
plt.plot(defA_909, loadA_909, 'og', mfc='none',label="90-0-90")
plt.plot(wA_909, P_909, '-g')


plt.xlabel('Downward deflection at point A x100')
plt.ylabel('Load at point A x1000')
plt.legend()
plt.show()


# GNL Pinched Cyilinder

P=np.array([0,0.05,0.075,0.1,0.125,0.15,0.175,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85,0.9,0.95,1])
wA=1/10*np.array([0,9.561,15.648,23.164,29.375,36.208,51.499,56.373,61.877,65.498,68.229,70.424,72.204,73.79,75.139,76.331,77.472,78.451,79.339,80.218,81.045,81.766,82.435,83.102])
uB=1/10*np.array([0,-0.233,-0.922,-2.391,-3.872,-2.154,6.792,10.448,14.905,17.979,20.365,22.321,23.916,25.381,26.631,27.735,28.843,29.772,30.604,31.471,32.299,32.989,33.619,34.272])


wA_model=[0.,  0.5, 1.,  1.5, 2.,  2.5, 3.,  3.5, 4.,  4.5, 5.,  5.5, 6.,  6.5, 7.,  7.5, 8.,8.5 ]
uB_model=[ 0.00000000e+00, -2.93478865e-03, -2.65343936e-02, -8.26224586e-02,-1.68641662e-01, -2.78903054e-01, -3.67905243e-01, -2.44718792e-01,-1.84641637e-02,  2.63652811e-01,  5.88818321e-01,  9.49081397e-01,1.34517611e+00,  1.77114971e+00,  2.21822763e+00,  2.68264343e+00,3.16504727e+00,  3.65964865e+00]
P_model=[0.,         0.03493715, 0.0626396,  0.08676804, 0.10577594, 0.12559888,0.14842593, 0.17116455, 0.18298411, 0.18827624, 0.19972972, 0.22665398,0.27060447, 0.34036659, 0.45392462, 0.63659561, 0.92032378, 1.35232526]



plt.plot(wA_model, P_model, 'or', mfc='none',label="-wA")
plt.plot(wA, 1.2*P, '-r')

plt.plot(uB_model, P_model, 'ob', mfc='none',label="uB")
plt.plot(uB, 1.2*P, '-b')



plt.xlabel('Displacements at point A and B (x10)')
plt.ylabel('Pinched force (x10000)')
plt.show()


# Pulled cylinder

wA_model = [0.,         0.82765436, 1.26840208, 1.53451014, 1.71256489, 1.84077787,1.93796479, 2.01464065, 2.07725715, 2.12989341, 2.17518661, 2.21490361,2.25027666, 2.28219944, 2.31134555, 2.33824477, 2.36333788, 2.38702601,2.40973804, 2.43208781, 2.4555481,  2.52263819, 2.55473999, 2.57637753,2.59359812, 2.60815616, 2.62088382, 2.63225676, 2.64257633, 2.65204736,2.66081668, 2.66899405, 2.6766643,  2.68389475, 2.69073995, 2.69724486,2.70344701, 2.7093781,  2.71506515, 2.72053136, 2.72579682]

uB_model =  [0.,         0.87689157, 1.48761646, 1.91820395, 2.23379277, 2.47229041,2.65617526, 2.80104465, 2.91851022, 3.01664166, 3.10079974, 3.17458214,3.24049231, 3.30035365, 3.35556687, 3.40728456, 3.45655561, 3.50449855,3.55263866, 3.60395793, 3.66873448, 4.06836988, 4.17605118, 4.23576908,4.27898514, 4.31336592, 4.34215929, 4.36707364, 4.38912341, 4.40896173,4.42703505, 4.44366311, 4.45908364, 4.47347876, 4.48699153, 4.49973656,4.51180728, 4.52328086, 4.53422186, 4.54468481, 4.55471621]

uC_model =  [0.,         0.8850065,  1.51051523, 1.96403441, 2.31105696, 2.58669259,2.80667493, 2.98066232, 3.11875904, 3.23011515, 3.32159539, 3.39800384,3.46267571, 3.51795481, 3.56551003, 3.60653205, 3.64184606, 3.67195385,3.6969781,  3.71634213, 3.72701941, 3.59410434, 3.53365628, 3.49713465,3.46973915, 3.44755637, 3.42881881, 3.41254654, 3.3981343,  3.38518127,3.37340773, 3.36260996, 3.35263416, 3.34336063, 3.33469379, 3.32655574,3.31888183, 3.31161771, 3.30471715, 3.29814042, 3.29185315]

# % refenrece solution from Sze et al, 2004
# % Popular benchmark problems for geometric nonlinear analysis of shells
Pz = 40000.0/10000

P_model=np.arange(0,Pz+Pz/40,Pz/40)


P = Pz * np.array([0, 0.025 , 0.05  , 0.075 , 0.1   , 0.15  , 0.20  , 0.25  , 0.30  , 0.35  , 0.40  , 0.45  , 0.5   , 0.525 , 0.55  , 0.6   , 0.65  , 0.7   , 0.75  , 0.8   , 0.85  , 0.9   , 0.95  , 1])
wA =     np.array([0, 0.819      , 1.26  , 1.527 , 1.707 , 1.936 , 2.079 , 2.180 , 2.257 , 2.321 , 2.376 , 2.425 , 2.473 , 2.543 , 2.577 , 2.618 , 2.648 , 2.672 , 2.692 , 2.710 , 2.726 , 2.741 , 2.755 , 2.768])
uB =     np.array([0, 0.864      , 1.471 , 1.901 , 2.217 , 2.641 , 2.904 , 3.087 , 3.227 , 3.342 , 3.443 , 3.539 , 3.653 , 4.061 , 4.171 , 4.274 , 4.338 , 4.385 , 4.423 , 4.455 , 4.483 , 4.508 , 4.53  , 4.551])
uC =     np.array([0, 0.872      , 1.493 , 1.946 , 2.293 , 2.792 , 3.106 , 3.310 , 3.452 , 3.556 , 3.632 , 3.688 , 3.718 , 3.580 , 3.518 , 3.452 , 3.410 , 3.378 , 3.353 , 3.332 , 3.313 , 3.297 , 3.283 , 3.269])


plt.plot(wA_model, np.array(P_model), 'or', mfc='none')
plt.plot(uB_model, np.array(P_model), 'ob', mfc='none')
plt.plot(uC_model, np.array(P_model), 'og', mfc='none')


plt.plot(wA, P, '-r')
plt.plot(uB, P, '-b')
plt.plot(uC, P, '-g')

plt.show()
